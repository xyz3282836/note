const t=JSON.parse('{"key":"v-296a96ce","path":"/apue/%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95.html","title":"第四章 文件目录","lang":"zh-CN","frontmatter":{"description":"第四章 文件目录 stat,fstat,fstatat,lstat #include &lt;sys/stat.h&gt; int stat(const char *restrict pathname,struct stat *restrict buf);//文件有关信息 int fstat(int fd,struct stat *buf);//获取文件有关信息 int lstat(const char *restrict pathname,struct stat *restrict buf);//link有关信息，比stat多检测link文件 int fstatat(int fd,const char *restrict pathname,struct stat *restrict buf,int flag);// struct stat{ mode_t st_mode;i节点 中文件访问权限 ino_t st_ino;目录项中 i节点编号 文件系统中的每个目录项都有一个唯一的i节点编号 dev_t st_dev;每个文件系统都有一个唯一的设备号 dev_t st_rdev; nlink_t st_nlink;有链接计数 uid_t st_uid; gid_t st_gid; off_t st_size; struct timespec st_atime; struct timespec st_mtime; struct timespec st_ctime; blksize_t st_blksize; blkcnt_t st_blocks; } struct timespec{ time_t tv_sec; long tv_nsec; ... } //附一份macos 10.13.4 truct stat { \\tdev_t\\t \\tst_dev;\\t\\t/* [XSI] ID of device containing file */ \\tino_t\\t \\tst_ino;\\t\\t/* [XSI] File serial number */ \\tmode_t\\t \\tst_mode;\\t/* [XSI] Mode of file (see below) */ \\tnlink_t\\t\\tst_nlink;\\t/* [XSI] Number of hard links */ \\tuid_t\\t\\tst_uid;\\t\\t/* [XSI] User ID of the file */ \\tgid_t\\t\\tst_gid;\\t\\t/* [XSI] Group ID of the file */ \\tdev_t\\t\\tst_rdev;\\t/* [XSI] Device ID */ #if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE) \\tstruct\\ttimespec st_atimespec;\\t/* time of last access */ \\tstruct\\ttimespec st_mtimespec;\\t/* time of last data modification */ \\tstruct\\ttimespec st_ctimespec;\\t/* time of last status change */ #else \\ttime_t\\t\\tst_atime;\\t/* [XSI] Time of last access */ \\tlong\\t\\tst_atimensec;\\t/* nsec of last access */ \\ttime_t\\t\\tst_mtime;\\t/* [XSI] Last data modification time */ \\tlong\\t\\tst_mtimensec;\\t/* last data modification nsec */ \\ttime_t\\t\\tst_ctime;\\t/* [XSI] Time of last status change */ \\tlong\\t\\tst_ctimensec;\\t/* nsec of last status change */ #endif \\toff_t\\t\\tst_size;\\t/* [XSI] file size, in bytes */ \\tblkcnt_t\\tst_blocks;\\t/* [XSI] blocks allocated for file */ \\tblksize_t\\tst_blksize;\\t/* [XSI] optimal blocksize for I/O */ \\t__uint32_t\\tst_flags;\\t/* user defined flags for file */ \\t__uint32_t\\tst_gen;\\t\\t/* file generation number */ \\t__int32_t\\tst_lspare;\\t/* RESERVED: DO NOT USE! */ \\t__int64_t\\tst_qspare[2];\\t/* RESERVED: DO NOT USE! */ };","head":[["meta",{"property":"og:url","content":"https://www.ruizhou.cf/apue/%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95.html"}],["meta",{"property":"og:site_name","content":"rz文档"}],["meta",{"property":"og:title","content":"第四章 文件目录"}],["meta",{"property":"og:description","content":"第四章 文件目录 stat,fstat,fstatat,lstat #include &lt;sys/stat.h&gt; int stat(const char *restrict pathname,struct stat *restrict buf);//文件有关信息 int fstat(int fd,struct stat *buf);//获取文件有关信息 int lstat(const char *restrict pathname,struct stat *restrict buf);//link有关信息，比stat多检测link文件 int fstatat(int fd,const char *restrict pathname,struct stat *restrict buf,int flag);// struct stat{ mode_t st_mode;i节点 中文件访问权限 ino_t st_ino;目录项中 i节点编号 文件系统中的每个目录项都有一个唯一的i节点编号 dev_t st_dev;每个文件系统都有一个唯一的设备号 dev_t st_rdev; nlink_t st_nlink;有链接计数 uid_t st_uid; gid_t st_gid; off_t st_size; struct timespec st_atime; struct timespec st_mtime; struct timespec st_ctime; blksize_t st_blksize; blkcnt_t st_blocks; } struct timespec{ time_t tv_sec; long tv_nsec; ... } //附一份macos 10.13.4 truct stat { \\tdev_t\\t \\tst_dev;\\t\\t/* [XSI] ID of device containing file */ \\tino_t\\t \\tst_ino;\\t\\t/* [XSI] File serial number */ \\tmode_t\\t \\tst_mode;\\t/* [XSI] Mode of file (see below) */ \\tnlink_t\\t\\tst_nlink;\\t/* [XSI] Number of hard links */ \\tuid_t\\t\\tst_uid;\\t\\t/* [XSI] User ID of the file */ \\tgid_t\\t\\tst_gid;\\t\\t/* [XSI] Group ID of the file */ \\tdev_t\\t\\tst_rdev;\\t/* [XSI] Device ID */ #if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE) \\tstruct\\ttimespec st_atimespec;\\t/* time of last access */ \\tstruct\\ttimespec st_mtimespec;\\t/* time of last data modification */ \\tstruct\\ttimespec st_ctimespec;\\t/* time of last status change */ #else \\ttime_t\\t\\tst_atime;\\t/* [XSI] Time of last access */ \\tlong\\t\\tst_atimensec;\\t/* nsec of last access */ \\ttime_t\\t\\tst_mtime;\\t/* [XSI] Last data modification time */ \\tlong\\t\\tst_mtimensec;\\t/* last data modification nsec */ \\ttime_t\\t\\tst_ctime;\\t/* [XSI] Time of last status change */ \\tlong\\t\\tst_ctimensec;\\t/* nsec of last status change */ #endif \\toff_t\\t\\tst_size;\\t/* [XSI] file size, in bytes */ \\tblkcnt_t\\tst_blocks;\\t/* [XSI] blocks allocated for file */ \\tblksize_t\\tst_blksize;\\t/* [XSI] optimal blocksize for I/O */ \\t__uint32_t\\tst_flags;\\t/* user defined flags for file */ \\t__uint32_t\\tst_gen;\\t\\t/* file generation number */ \\t__int32_t\\tst_lspare;\\t/* RESERVED: DO NOT USE! */ \\t__int64_t\\tst_qspare[2];\\t/* RESERVED: DO NOT USE! */ };"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-03-11T14:36:50.000Z"}],["meta",{"property":"article:modified_time","content":"2023-03-11T14:36:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"第四章 文件目录\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-03-11T14:36:50.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"stat,fstat,fstatat,lstat","slug":"stat-fstat-fstatat-lstat","link":"#stat-fstat-fstatat-lstat","children":[]},{"level":2,"title":"文件类型","slug":"文件类型","link":"#文件类型","children":[]},{"level":2,"title":"设置用户 ID 和设置组 ID","slug":"设置用户-id-和设置组-id","link":"#设置用户-id-和设置组-id","children":[]},{"level":2,"title":"文件访问权限","slug":"文件访问权限","link":"#文件访问权限","children":[]},{"level":2,"title":"新文件和目录的所有权","slug":"新文件和目录的所有权","link":"#新文件和目录的所有权","children":[]},{"level":2,"title":"umask","slug":"umask","link":"#umask","children":[]},{"level":2,"title":"chmod,fchmod,fchmodat","slug":"chmod-fchmod-fchmodat","link":"#chmod-fchmod-fchmodat","children":[]},{"level":2,"title":"chown,fchown,fchownat,lchown","slug":"chown-fchown-fchownat-lchown","link":"#chown-fchown-fchownat-lchown","children":[]},{"level":2,"title":"文件长度","slug":"文件长度","link":"#文件长度","children":[]},{"level":2,"title":"文件空洞","slug":"文件空洞","link":"#文件空洞","children":[]},{"level":2,"title":"文件截断","slug":"文件截断","link":"#文件截断","children":[]},{"level":2,"title":"文件系统","slug":"文件系统","link":"#文件系统","children":[]},{"level":2,"title":"link,linkat,unlink,unlinkat,remove","slug":"link-linkat-unlink-unlinkat-remove","link":"#link-linkat-unlink-unlinkat-remove","children":[]},{"level":2,"title":"rename,renameat","slug":"rename-renameat","link":"#rename-renameat","children":[]},{"level":2,"title":"符号链接","slug":"符号链接","link":"#符号链接","children":[]},{"level":2,"title":"创建和读取符号链接","slug":"创建和读取符号链接","link":"#创建和读取符号链接","children":[]},{"level":2,"title":"文件的时间","slug":"文件的时间","link":"#文件的时间","children":[]},{"level":2,"title":"futimens,utimensat,utimes","slug":"futimens-utimensat-utimes","link":"#futimens-utimensat-utimes","children":[]},{"level":2,"title":"mkdir,mkdirat,rmdir","slug":"mkdir-mkdirat-rmdir","link":"#mkdir-mkdirat-rmdir","children":[]},{"level":2,"title":"读目录","slug":"读目录","link":"#读目录","children":[]},{"level":2,"title":"chdir,fchdir,getcwd","slug":"chdir-fchdir-getcwd","link":"#chdir-fchdir-getcwd","children":[]},{"level":2,"title":"设备特殊文件","slug":"设备特殊文件","link":"#设备特殊文件","children":[]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"git":{"createdTime":1678545410000,"updatedTime":1678545410000,"contributors":[{"name":"liuruizhou","email":"liuruizhou@bilibili.com","commits":1}]},"readingTime":{"minutes":10.99,"words":3298},"filePathRelative":"apue/第四章 文件目录.md","localizedDate":"2023年3月11日","excerpt":"<h1> 第四章 文件目录</h1>\\n<h2> stat,fstat,fstatat,lstat</h2>\\n<div class=\\"language-c line-numbers-mode\\" data-ext=\\"c\\"><pre class=\\"language-c\\"><code><span class=\\"token macro property\\"><span class=\\"token directive-hash\\">#</span><span class=\\"token directive keyword\\">include</span> <span class=\\"token string\\">&lt;sys/stat.h&gt;</span></span>\\n<span class=\\"token keyword\\">int</span> <span class=\\"token function\\">stat</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">const</span> <span class=\\"token keyword\\">char</span> <span class=\\"token operator\\">*</span>restrict pathname<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">stat</span> <span class=\\"token operator\\">*</span>restrict buf<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span><span class=\\"token comment\\">//文件有关信息</span>\\n<span class=\\"token keyword\\">int</span> <span class=\\"token function\\">fstat</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">int</span> fd<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">stat</span> <span class=\\"token operator\\">*</span>buf<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span><span class=\\"token comment\\">//获取文件有关信息</span>\\n<span class=\\"token keyword\\">int</span> <span class=\\"token function\\">lstat</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">const</span> <span class=\\"token keyword\\">char</span> <span class=\\"token operator\\">*</span>restrict pathname<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">stat</span> <span class=\\"token operator\\">*</span>restrict buf<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span><span class=\\"token comment\\">//link有关信息，比stat多检测link文件</span>\\n<span class=\\"token keyword\\">int</span> <span class=\\"token function\\">fstatat</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">int</span> fd<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">const</span> <span class=\\"token keyword\\">char</span> <span class=\\"token operator\\">*</span>restrict pathname<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">stat</span> <span class=\\"token operator\\">*</span>restrict buf<span class=\\"token punctuation\\">,</span><span class=\\"token keyword\\">int</span> flag<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span><span class=\\"token comment\\">//</span>\\n\\n<span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">stat</span><span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token class-name\\">mode_t</span>          st_mode<span class=\\"token punctuation\\">;</span>i节点 中文件访问权限\\n    <span class=\\"token class-name\\">ino_t</span>           st_ino<span class=\\"token punctuation\\">;</span>目录项中 i节点编号  文件系统中的每个目录项都有一个唯一的i节点编号\\n    <span class=\\"token class-name\\">dev_t</span>           st_dev<span class=\\"token punctuation\\">;</span>每个文件系统都有一个唯一的设备号\\n    <span class=\\"token class-name\\">dev_t</span>           st_rdev<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token class-name\\">nlink_t</span>         st_nlink<span class=\\"token punctuation\\">;</span>有链接计数\\n    <span class=\\"token class-name\\">uid_t</span>           st_uid<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token class-name\\">gid_t</span>           st_gid<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token class-name\\">off_t</span>           st_size<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">timespec</span> st_atime<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">timespec</span> st_mtime<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">timespec</span> st_ctime<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token class-name\\">blksize_t</span>       st_blksize<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token class-name\\">blkcnt_t</span>        st_blocks<span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n<span class=\\"token keyword\\">struct</span> <span class=\\"token class-name\\">timespec</span><span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token class-name\\">time_t</span> tv_sec<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token keyword\\">long</span>   tv_nsec<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">.</span><span class=\\"token punctuation\\">.</span><span class=\\"token punctuation\\">.</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token comment\\">//附一份macos 10.13.4</span>\\ntruct stat <span class=\\"token punctuation\\">{</span>\\n\\t<span class=\\"token class-name\\">dev_t</span>\\t \\tst_dev<span class=\\"token punctuation\\">;</span>\\t\\t<span class=\\"token comment\\">/* [XSI] ID of device containing file */</span>\\n\\t<span class=\\"token class-name\\">ino_t</span>\\t  \\tst_ino<span class=\\"token punctuation\\">;</span>\\t\\t<span class=\\"token comment\\">/* [XSI] File serial number */</span>\\n\\t<span class=\\"token class-name\\">mode_t</span>\\t \\tst_mode<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Mode of file (see below) */</span>\\n\\t<span class=\\"token class-name\\">nlink_t</span>\\t\\tst_nlink<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Number of hard links */</span>\\n\\t<span class=\\"token class-name\\">uid_t</span>\\t\\tst_uid<span class=\\"token punctuation\\">;</span>\\t\\t<span class=\\"token comment\\">/* [XSI] User ID of the file */</span>\\n\\t<span class=\\"token class-name\\">gid_t</span>\\t\\tst_gid<span class=\\"token punctuation\\">;</span>\\t\\t<span class=\\"token comment\\">/* [XSI] Group ID of the file */</span>\\n\\t<span class=\\"token class-name\\">dev_t</span>\\t\\tst_rdev<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Device ID */</span>\\n<span class=\\"token macro property\\"><span class=\\"token directive-hash\\">#</span><span class=\\"token directive keyword\\">if</span> <span class=\\"token expression\\"><span class=\\"token operator\\">!</span><span class=\\"token function\\">defined</span><span class=\\"token punctuation\\">(</span>_POSIX_C_SOURCE<span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">||</span> <span class=\\"token function\\">defined</span><span class=\\"token punctuation\\">(</span>_DARWIN_C_SOURCE<span class=\\"token punctuation\\">)</span></span></span>\\n\\t<span class=\\"token keyword\\">struct</span>\\t<span class=\\"token class-name\\">timespec</span> st_atimespec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* time of last access */</span>\\n\\t<span class=\\"token keyword\\">struct</span>\\t<span class=\\"token class-name\\">timespec</span> st_mtimespec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* time of last data modification */</span>\\n\\t<span class=\\"token keyword\\">struct</span>\\t<span class=\\"token class-name\\">timespec</span> st_ctimespec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* time of last status change */</span>\\n<span class=\\"token macro property\\"><span class=\\"token directive-hash\\">#</span><span class=\\"token directive keyword\\">else</span></span>\\n\\t<span class=\\"token class-name\\">time_t</span>\\t\\tst_atime<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Time of last access */</span>\\n\\t<span class=\\"token keyword\\">long</span>\\t\\tst_atimensec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* nsec of last access */</span>\\n\\t<span class=\\"token class-name\\">time_t</span>\\t\\tst_mtime<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Last data modification time */</span>\\n\\t<span class=\\"token keyword\\">long</span>\\t\\tst_mtimensec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* last data modification nsec */</span>\\n\\t<span class=\\"token class-name\\">time_t</span>\\t\\tst_ctime<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] Time of last status change */</span>\\n\\t<span class=\\"token keyword\\">long</span>\\t\\tst_ctimensec<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* nsec of last status change */</span>\\n<span class=\\"token macro property\\"><span class=\\"token directive-hash\\">#</span><span class=\\"token directive keyword\\">endif</span></span>\\n\\t<span class=\\"token class-name\\">off_t</span>\\t\\tst_size<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] file size, in bytes */</span>\\n\\t<span class=\\"token class-name\\">blkcnt_t</span>\\tst_blocks<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] blocks allocated for file */</span>\\n\\t<span class=\\"token class-name\\">blksize_t</span>\\tst_blksize<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* [XSI] optimal blocksize for I/O */</span>\\n\\t__uint32_t\\tst_flags<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* user defined flags for file */</span>\\n\\t__uint32_t\\tst_gen<span class=\\"token punctuation\\">;</span>\\t\\t<span class=\\"token comment\\">/* file generation number */</span>\\n\\t__int32_t\\tst_lspare<span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* RESERVED: DO NOT USE! */</span>\\n\\t__int64_t\\tst_qspare<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">2</span><span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">;</span>\\t<span class=\\"token comment\\">/* RESERVED: DO NOT USE! */</span>\\n<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{t as data};
