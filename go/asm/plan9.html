<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.ruizhou.cf/go/asm/plan9.html"><meta property="og:site_name" content="rz文档"><meta property="og:title" content="go plan9"><meta property="og:description" content="基本指令 https://go.xargin.com/docs/assembly/assembly/ MOV 数据搬运，赋值; LEA 取址 &; TEST; CMP 比较; JLS （ jump less ）小于时跳转; JMP（ jump ）无条件跳转; JEQ（ jump equal ）等于时跳转; SUB 相减，结果保存到目标操作数; ADD ..."><meta property="og:type" content="article"><meta property="og:image" content="https://www.ruizhou.cf/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-03-11T14:36:50.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="go plan9"><meta property="article:modified_time" content="2023-03-11T14:36:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"go plan9","image":["https://www.ruizhou.cf/"],"dateModified":"2023-03-11T14:36:50.000Z","author":[]}</script><title>go plan9 | rz文档</title><meta name="description" content="基本指令 https://go.xargin.com/docs/assembly/assembly/ MOV 数据搬运，赋值; LEA 取址 &; TEST; CMP 比较; JLS （ jump less ）小于时跳转; JMP（ jump ）无条件跳转; JEQ（ jump equal ）等于时跳转; SUB 相减，结果保存到目标操作数; ADD ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-ef8bc981.css" as="style"><link rel="stylesheet" href="/assets/style-ef8bc981.css">
    <link rel="modulepreload" href="/assets/app-e5f4882f.js"><link rel="modulepreload" href="/assets/framework-c08a2544.js"><link rel="modulepreload" href="/assets/plan9.html-89bb0002.js"><link rel="modulepreload" href="/assets/plan9.html-21813080.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/hero.png" alt="rz文档"><!----><span class="site-name hide-in-pad">rz文档</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="rz的文档"><span class="font-icon icon iconfont icon-home" style=""></span>rz的文档<!----></a></div><div class="nav-item hide-in-mobile"><a href="/go/" class="nav-link active" aria-label="Go"><!---->Go<!----></a></div><div class="nav-item hide-in-mobile"><a href="/linux/" class="nav-link" aria-label="Liunx"><!---->Liunx<!----></a></div><div class="nav-item hide-in-mobile"><a href="/apue/" class="nav-link" aria-label="Unix环境高级编程"><!---->Unix环境高级编程<!----></a></div><div class="nav-item hide-in-mobile"><a href="/source-code/" class="nav-link" aria-label="源码解读"><!---->源码解读<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/xyz3282836/monodoc" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="rz的文档"><span class="font-icon icon iconfont icon-home" style=""></span>rz的文档<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Go</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/go/%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="版本升级"><!---->版本升级<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/%E6%A6%82%E5%BF%B5.html" class="nav-link sidebar-link sidebar-page" aria-label="基础概念"><!---->基础概念<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/%E6%AF%9B%E5%89%91.html" class="nav-link sidebar-link sidebar-page" aria-label="毛老师语录"><!---->毛老师语录<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/%E6%9D%82%E9%A1%B9.html" class="nav-link sidebar-link sidebar-page" aria-label="杂项"><!---->杂项<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Asm</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/go/asm/%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="基础"><!---->基础<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/asm/monkey%20patch.html" class="nav-link sidebar-link sidebar-page" aria-label="主要思路"><!---->主要思路<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/asm/dlv%E5%91%BD%E4%BB%A4.html" class="nav-link sidebar-link sidebar-page" aria-label="dlv 命令"><!---->dlv 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/go/asm/plan9.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="go plan9"><!---->go plan9<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#基本指令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基本指令"><!---->基本指令<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#栈调整" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="栈调整"><!---->栈调整<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#数据计算" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="数据计算"><!---->数据计算<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#内存操作" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="内存操作"><!---->内存操作<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#条件调转" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="条件调转"><!---->条件调转<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#寄存器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="寄存器"><!---->寄存器<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#通用寄存器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="通用寄存器"><!---->通用寄存器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#伪寄存器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="伪寄存器"><!---->伪寄存器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#变量声明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="变量声明"><!---->变量声明<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#函数声明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="函数声明"><!---->函数声明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#栈结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="栈结构"><!---->栈结构<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#argsize-和-framsize" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="argsize 和 framsize"><!---->argsize 和 framsize<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#伪寄存器-sp-、伪寄存器-fp-和硬件寄存器-sp" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="伪寄存器 SP 、伪寄存器 FP 和硬件寄存器 SP"><!---->伪寄存器 SP 、伪寄存器 FP 和硬件寄存器 SP<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#其他" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="其他"><!---->其他<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#simd" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SIMD"><!---->SIMD<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/go/asm/plan9.html#demo" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="demo"><!---->demo<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li><li><!--[--><a href="/go/dlv%E5%91%BD%E4%BB%A4.html" class="nav-link sidebar-link sidebar-page" aria-label="dlv 命令"><!---->dlv 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/gc.html" class="nav-link sidebar-link sidebar-page" aria-label="gc"><!---->gc<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/Go%20%E9%97%AD%E5%8C%85.html" class="nav-link sidebar-link sidebar-page" aria-label="go 闭包"><!---->go 闭包<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/go%20%E8%B0%83%E5%BA%A6.html" class="nav-link sidebar-link sidebar-page" aria-label="go 的调度"><!---->go 的调度<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/go%20%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="go 基础"><!---->go 基础<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/go%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4.html" class="nav-link sidebar-link sidebar-page" aria-label="go 命令"><!---->go 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/gogc%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" aria-label="go gc 性能优化"><!---->go gc 性能优化<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/mod.html" class="nav-link sidebar-link sidebar-page" aria-label="Go Mod"><!---->Go Mod<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/go%20test.html" class="nav-link sidebar-link sidebar-page" aria-label="go test"><!---->go test<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/go%20tool%20compile.html" class="nav-link sidebar-link sidebar-page" aria-label="go tool compile"><!---->go tool compile<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/gpm.html" class="nav-link sidebar-link sidebar-page" aria-label="gpm"><!---->gpm<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/kafka.html" class="nav-link sidebar-link sidebar-page" aria-label="kafka"><!---->kafka<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Profiles</span><span class="arrow end"></span></button><!----></section></li><li><!--[--><a href="/go/proto%20%E5%BA%8F%E5%88%97%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" aria-label="proto"><!---->proto<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/protoc.html" class="nav-link sidebar-link sidebar-page" aria-label="protoc"><!---->protoc<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/go/test.html" class="nav-link sidebar-link sidebar-page" aria-label="test md img"><!---->test md img<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">源码解读</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Unix环境高级编程</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Liunx</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">算法</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">数据结构</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">操作系统</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">技术</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">领域设计</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">术语</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">性能之巅</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">其他</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">待办</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->go plan9</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/xyz3282836/monodoc" target="_blank" rel="noopener noreferrer">rz</a></span><span property="author" content="rz"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-11T14:36:50.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 21 分钟</span><meta property="timeRequired" content="PT21M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#基本指令" class="router-link-active router-link-exact-active toc-link level2">基本指令</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#栈调整" class="router-link-active router-link-exact-active toc-link level3">栈调整</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#数据计算" class="router-link-active router-link-exact-active toc-link level3">数据计算</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#内存操作" class="router-link-active router-link-exact-active toc-link level3">内存操作</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#条件调转" class="router-link-active router-link-exact-active toc-link level3">条件调转</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#寄存器" class="router-link-active router-link-exact-active toc-link level2">寄存器</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#通用寄存器" class="router-link-active router-link-exact-active toc-link level3">通用寄存器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#伪寄存器" class="router-link-active router-link-exact-active toc-link level3">伪寄存器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#变量声明" class="router-link-active router-link-exact-active toc-link level3">变量声明</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#函数声明" class="router-link-active router-link-exact-active toc-link level2">函数声明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#栈结构" class="router-link-active router-link-exact-active toc-link level2">栈结构</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#argsize-和-framsize" class="router-link-active router-link-exact-active toc-link level3">argsize 和 framsize</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#伪寄存器-sp-、伪寄存器-fp-和硬件寄存器-sp" class="router-link-active router-link-exact-active toc-link level3">伪寄存器 SP 、伪寄存器 FP 和硬件寄存器 SP</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#其他" class="router-link-active router-link-exact-active toc-link level3">其他</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#simd" class="router-link-active router-link-exact-active toc-link level3">SIMD</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/go/asm/plan9.html#demo" class="router-link-active router-link-exact-active toc-link level3">demo</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="go-plan9" tabindex="-1"><a class="header-anchor" href="#go-plan9" aria-hidden="true">#</a> go plan9</h1><h2 id="基本指令" tabindex="-1"><a class="header-anchor" href="#基本指令" aria-hidden="true">#</a> 基本指令</h2><p><a href="https://go.xargin.com/docs/assembly/assembly/" target="_blank" rel="noopener noreferrer">https://go.xargin.com/docs/assembly/assembly/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>MOV 数据搬运，赋值</li><li>LEA 取址 &amp;</li><li>TEST</li><li>CMP 比较</li><li>JLS （ jump less ）小于时跳转</li><li>JMP（ jump ）无条件跳转</li><li>JEQ（ jump equal ）等于时跳转</li><li>SUB 相减，结果保存到目标操作数</li><li>ADD 相加，结果保存到目标操作数</li><li>RET 返回</li><li>NOP 空指令</li><li>CALL 调用函数</li><li>SHL（ shift logical left ） 逻辑左移指令 <code>&lt;&lt;</code></li><li>SHR（ shift logical right ） 逻辑右移指令 <code>&gt;&gt;</code>，右移时不保留操作数的符号，用 0 代替</li><li>SAL（ shift arithmetic left ）算术左移指令</li><li>SAR（ shift arithmetic right ）算术右移指令，右移时保留操作数的符号</li><li>XADD：交换并相加</li><li>NEG：求补指令，就是取相反数</li><li>XORPS：源操作数（第二个操作数）与目标操作数（第一个操作数）进行异或。结果保存到目标操作数</li><li>MOVUPS：与 MOV 一样，操作对象的类型不一样，这里是包含四个压缩单精度浮点值的双四字</li><li>XCHG: 交换两个操作数内容，自带 LOCK 总线锁属性</li></ul><blockquote><p>MOV 指令有有好几种后缀 MOVB MOVW MOVL MOVQ 分别对应的是 1 字节 、2 字节 、4 字节、8 字节</p></blockquote><h3 id="栈调整" tabindex="-1"><a class="header-anchor" href="#栈调整" aria-hidden="true">#</a> 栈调整</h3><p>intel 或 AT&amp;T 汇编提供了 push 和 pop 指令族，<s>plan9 中没有 push 和 pop</s>，plan9 中虽然有 push 和 pop 指令，但一般生成的代码中是没有的，我们看到的栈的调整大多是通过对硬件 SP 寄存器进行运算来实现的，例如:</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>SUBQ $0x18, SP // 对 SP 做减法，为函数分配函数栈帧
...               // 省略无用代码
ADDQ $0x18, SP // 对 SP 做加法，清除函数栈帧
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通用的指令和 X64 平台差不多，下面分节详述。</p><p>常数在 plan9 汇编用 $num 表示，可以为负数，默认情况下为十进制。可以用 $0x123 的形式来表示十六进制数。</p><h3 id="数据计算" tabindex="-1"><a class="header-anchor" href="#数据计算" aria-hidden="true">#</a> 数据计算</h3><p>data moves from left to right</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>ADD R1, R2 // R2 += R1
SUB R3, R4, R5 // R5 = R4 - R3
MUL $7, R6 // R6 *= 7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="内存操作" tabindex="-1"><a class="header-anchor" href="#内存操作" aria-hidden="true">#</a> 内存操作</h3><p>memory oprands: offset + reg1 + reg2*scale</p><p><code>(AX)</code>表示 <code>*AX</code>，取地址对应的值</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>MOV (R1), R2 // R2 = *R1  取R1的地址对应的值
MOV 8(R3), R4 // R4 = *(8 + R3)
MOV 16(R5)(R6*1), R7 // R7 = *(16 + R5 + R6*1)
MOV ·MYVAR(SB), R8 // R8 = *MYVAR

MOV $8(R1)(R2*1), R3 // R3 = 8
MOV $·MYVAR(SB), R4 // R4 = &amp;MYVAR 地址赋值给R4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="条件调转" tabindex="-1"><a class="header-anchor" href="#条件调转" aria-hidden="true">#</a> 条件调转</h3><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>// 跳转
JMP addr
JMP label
JMP 2(PC)
JMP -2(PC)

JZ target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="寄存器" tabindex="-1"><a class="header-anchor" href="#寄存器" aria-hidden="true">#</a> 寄存器</h2><h3 id="通用寄存器" tabindex="-1"><a class="header-anchor" href="#通用寄存器" aria-hidden="true">#</a> 通用寄存器</h3><p>应用层代码使用的通用寄存器主要是</p><p>rax,rbx,rcx,rdx</p><p>rdi,rsi</p><p>r8,r9,...r14,r15</p><p>rbp,rsp，虽然 rbp 和 rsp 也可以用，不过 bp 和 sp 会被用来管理栈顶和栈底，最好不要拿来进行运算</p><p>rip 其实就是 pc(program count)</p><p>plan9 不需要 r 或者 e 的前缀，x64 平台寄存器在 plan9 的标识</p><table><thead><tr><th style="text-align:left;">X64</th><th>rax</th><th>rbx</th><th>rcx</th><th>rdx</th><th>rdi</th><th>rsi</th><th>rbp</th><th>rsp</th><th>r8</th><th>r9</th><th>r10</th><th>r11</th><th>r12</th><th>r13</th><th>r14</th><th>r15</th><th>rip</th></tr></thead><tbody><tr><td style="text-align:left;">Plan9</td><td>AX</td><td>BX</td><td>CX</td><td>DX</td><td>DI</td><td>SI</td><td>BP</td><td>SP</td><td>R8</td><td>R9</td><td>R10</td><td>R11</td><td>R12</td><td>R13</td><td>R14</td><td>R15</td><td>PC</td></tr></tbody></table><h3 id="伪寄存器" tabindex="-1"><a class="header-anchor" href="#伪寄存器" aria-hidden="true">#</a> 伪寄存器</h3><p>Go 的汇编还引入了 4 个伪寄存器，援引官方文档的描述:</p><blockquote><ul><li><code>FP</code>: Frame pointer: arguments and locals.</li><li><code>PC</code>: Program counter: jumps and branches.</li><li><code>SB</code>: Static base pointer: global symbols.</li><li><code>SP</code>: Stack pointer: <code>the highest address</code> within the local stack frame.</li></ul></blockquote><ul><li><p>FP: 使用形如 <code>symbol+offset(FP)</code> 的方式，引用<code>函数的输入参数</code>。例如 <code>arg0+0(FP)</code>，<code>arg1+8(FP)</code>，使用 FP 不加 symbol 时，无法通过编译，在汇编层面来讲，symbol 并没有什么用，加 symbol 主要是为了提升代码可读性。另外，官方文档虽然将伪寄存器 FP 称之为 frame pointer，<code>实际上它根本不是 frame pointer</code>，按照传统的 x86 的习惯来讲，frame pointer 是指向整个 stack frame 底部的 BP 寄存器。假如当前的 callee 函数是 add，在 add 的代码中引用 FP，该 FP 指向的位置不在 callee 的 stack frame 之内，而是在 caller 的 stack frame 上。FP 和 Go 的官方源代码里的 framepointer 不是一回事，源代码里的 framepointer 指的是 caller BP 寄存器的值，在这里和 caller 的伪 SP 是值是相等的。</p></li><li><p>PC: 实际上就是在体系结构的知识中常见的 <code>pc 寄存器</code>，在 x86 平台下对应 ip 寄存器，amd64 上则是 rip。除了个别跳转之外，手写 plan9 代码与 PC 寄存器打交道的情况较少。</p></li><li><p>SB: 全局静态基指针，一般用来<code>声明函数或全局变量</code>。</p></li><li><p>SP: plan9 的这个 SP 寄存器<code>指向当前栈帧的局部变量的开始位置</code>，使用形如 <code>symbol+offset(SP)</code> 的方式，引用函数的局部变量。offset 的合法取值是 [-framesize, 0)，注意是个左闭右开的区间。假如局部变量都是 8 字节，那么第一个局部变量就可以用 <code>localvar0-8(SP)</code> 来表示。这也是一个词不表意的寄存器。与硬件寄存器 SP 是两个不同的东西，在栈帧 size 为 0 的情况下，伪寄存器 SP 和硬件寄存器 SP 指向同一位置。手写汇编代码时，如果是 <code>symbol+offset(SP)</code> 形式，则表示伪寄存器 SP。如果是 <code>offset(SP)</code> 则表示硬件寄存器 SP。务必注意。对于编译输出(go tool compile -S / go tool objdump)的代码来讲，目前所有的 SP 都是硬件寄存器 SP，无论是否带 symbol。</p></li><li><p>在 go tool objdump/go tool compile -S 输出的代码中，是没有伪 SP 和 FP 寄存器的，我们上面说的区分伪 SP 和硬件 SP 寄存器的方法，对于上述两个命令的输出结果是没法使用的。在编译和反汇编的结果中，只有真实的 SP 寄存器。</p></li><li><p>FP 和 Go 的官方源代码里的 framepointer 不是一回事，源代码里的 framepointer 指的是 caller BP 寄存器的值，在这里和 caller 的伪 SP 是值是相等的。</p></li></ul><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>MOVQ BP,48(SP) // offset(SP)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="变量声明" tabindex="-1"><a class="header-anchor" href="#变量声明" aria-hidden="true">#</a> 变量声明</h3><p>使用 DATA 结合 GLOBL 来定义一个变量。DATA 的用法为:</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>DATA symbol+offset(SB)/width, value
定义一个变量 offset一般为0(定义数组，第二个元素开始就不是0)，是相对于symbol的偏移，width是大小，value是值
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 GLOBL 指令将变量声明为 global，额外接收两个参数，一个是 flag，另一个是变量的总大小。</p><p>GLOBL 必须跟在 DATA 指令之后</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>DATA age+0x00(SB)/4, $18  // 定义一个age的变量，4个字节，值是18
GLOBL age(SB), RODATA, $4 // 跟在DATA命令的后面一行，将age变量定义成global全局变量，flag是只读，大小也就是前面DATA定义的width，4个字节；第一个参数offset省略，直接 varname(SB)

// 定义个pi变量，大小是8个字节，值3.14...，并且设置为全局变量，只读
DATA pi+0(SB)/8, $3.1415926
GLOBL pi(SB), RODATA, $8

// offset 不为0的情况，&lt;&gt;标识表示只在当前文件中生效
DATA bio&lt;&gt;+0(SB)/8, $&quot;xiao ming&quot;
DATA bio&lt;&gt;+8(SB)/8, $&quot;xiao hong&quot;
GLOBOL bio&lt;&gt;(SB), RODATA, $16
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>flag 还可以是</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// Don&#39;t profile the marked routine. This flag is deprecated.过期了，给TEXT用的</span>
NOPROF	<span class="token number">1</span>

<span class="token comment">// It is ok for the linker to get multiple of these symbols. It will</span>
<span class="token comment">// pick one of the duplicates to use.</span>
DUPOK	<span class="token number">2</span>

<span class="token comment">// Don&#39;t insert stack check preamble.给TEXT用的</span>
NOSPLIT	<span class="token number">4</span>

<span class="token comment">// Put this data in a read-only section.给DATA和GLOBOL用的</span>
#define RODATA	<span class="token number">8</span>

<span class="token comment">// This data contains no pointers.给DATA和GLOBOL用的</span>
#define NOPTR	<span class="token number">16</span>

<span class="token comment">// This is a wrapper function and should not count as disabling &#39;recover&#39;.给TEXT用的</span>
#define WRAPPER <span class="token number">32</span>

<span class="token comment">// This function uses its incoming context register.给TEXT用的</span>
#define NEEDCTXT <span class="token number">64</span>

<span class="token comment">// Allocate a word of thread local storage and store the offset from the</span>
<span class="token comment">// thread local base to the thread local storage in this variable.给DATA和GLOBOL用的</span>
#define TLSBSS	<span class="token number">256</span>

<span class="token comment">// Do not insert instructions to allocate a stack frame for this function.</span>
<span class="token comment">// Only valid on functions that declare a frame size of 0.</span>
<span class="token comment">// TODO(mwhudson): only implemented for ppc64x at present.给TEXT用的</span>
#define NOFRAME <span class="token number">512</span>

<span class="token comment">// Function can call reflect.Type.Method or reflect.Type.MethodByName.</span>
#define REFLECTMETHOD <span class="token number">1024</span>

<span class="token comment">// Function is the top of the call stack. Call stack unwinders should stop</span>
<span class="token comment">// at this function.给TEXT用的</span>
#define TOPFRAME <span class="token number">2048</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当使用这些 flag 的字面量时，需要在汇编文件中 <code>#include &quot;textflag.h&quot;</code>。</p><p>.s 文件可以读取.go 文件中的变量，以及.go 定义一个 func，.s 来实现这个 func，必须在一个包文件目录下，go build，go test 都是可以的</p><h2 id="函数声明" tabindex="-1"><a class="header-anchor" href="#函数声明" aria-hidden="true">#</a> 函数声明</h2><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>// func add(a, b int) int
//   =&gt; 该声明定义在同一个 package 下的任意 .go 文件中
//   =&gt; 只有函数头，没有实现
TEXT pkgname·add(SB), NOSPLIT, $0-8
    MOVQ a+0(FP), AX
    MOVQ a+8(FP), BX
    ADDQ AX, BX
    MOVQ BX, ret+16(FP)
    RET
// · mac下输入方法是 option+shift+9

                              参数及返回值大小
                                  |
 TEXT pkgname·add(SB),NOSPLIT,$32-32
       |        |               |
      包名     函数名         栈帧大小(局部变量+可能需要的额外调用函数的参数空间的总大小，但不包括调用其它函数时的 ret address 的大小)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="栈结构" tabindex="-1"><a class="header-anchor" href="#栈结构" aria-hidden="true">#</a> 栈结构</h2><p>下面是一个典型的函数的栈结构图:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>                       -----------------
                       current func arg0
                       ----------------- &lt;----------- FP(pseudo FP)
                        caller ret addr  ---不算在当前栈帧内
                       +---------------+
                       | caller BP(*)  |
                       ----------------- &lt;----------- SP(pseudo SP，实际上是当前栈帧的 BP 位置)
                       |   Local Var0  |
                       -----------------
                       |   Local Var1  |
                       -----------------
                       |   Local Var2  |
                       -----------------
                       |   ........    |
                       -----------------
                       |   Local VarN  |
                       -----------------
                       |               |
                       |               |
                       |  temporarily  |
                       |  unused space |
                       |               |
                       |               |
                       -----------------
                       |  call retn    |
                       -----------------
                       |  call ret(n-1)|
                       -----------------
                       |  ..........   |
                       -----------------
                       |  call ret1    |
                       -----------------
                       |  call argn    |
                       -----------------
                       |   .....       |
                       -----------------
                       |  call arg3    |
                       -----------------
                       |  call arg2    |
                       |---------------|
                       |  call arg1    |
                       -----------------   &lt;------------  hardware SP 位置
                         return addr
                       +---------------+

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从原理上来讲，如果当前函数调用了其它函数，那么 return addr 也是在 caller 的栈上的，不过往栈上插 return addr 的过程是由 CALL 指令完成的，在 RET 时，SP 又会恢复到图上位置。我们在计算 SP 和参数相对位置时，可以认为硬件 SP 指向的就是图上的位置。</p><p>图上的 caller BP，指的是 caller 的 BP 寄存器值，有些人把 caller BP 叫作 caller 的 frame pointer，实际上这个习惯是从 x86 架构沿袭来的。Go 的 asm 文档中把伪寄存器 FP 也称为 frame pointer，但是这两个 frame pointer 根本不是一回事。</p><p>是否插入 BP(源代码中的 fram pointer)条件 1： 函数栈帧大小大于 0，2：Framepointer_enabled 返回 true 没有插入 caller BP，伪 SP 和伪 FP 相差 caller ret addr 的 8 个字节，插入的话就多出 8 字节，一共 16 字节</p><p>stack 从高地址向低地址增长，FP 参数是 argN 在高地址，arg1 在低地址，以参数和变量都占用 8 个字节为例子，用 <code>symname+0(FP)访问第一个参数</code>，<code>symname+8(FP)访问第二个参数</code>，以此类推。</p><p>用伪 SP 来引用局部变量，原理上来讲差不多，不过因为伪 SP 指向的是局部变量的底部，所以 <code>symname-8(SP) 表示的是第一个局部变量</code>，<code>symname-16(SP)表示第二个</code>，以此类推</p><figure><img src="/assets/image-20220709144517363-8174b227.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="argsize-和-framsize" tabindex="-1"><a class="header-anchor" href="#argsize-和-framsize" aria-hidden="true">#</a> argsize 和 framsize</h3><h4 id="argsize" tabindex="-1"><a class="header-anchor" href="#argsize" aria-hidden="true">#</a> argsize</h4><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>TEXT pkgname·add(SB),NOSPLIT,$16-32 // $framesize-argsize
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>一般大小求和+返回值大小求和，如 4 个 int64 参数，2 个 int64 返回值，就是 48 个字节</p><p>如果不确定自己的函数签名需要多大的 argsize，可以通过简单实现一个相同签名的空函数，然后 go tool objdump 来逆向查找应该分配多少空间。</p><h4 id="framesize" tabindex="-1"><a class="header-anchor" href="#framesize" aria-hidden="true">#</a> framesize</h4><p>函数的 framesize 就稍微复杂一些了，手写代码的 framesize 不需要考虑由编译器插入的 caller BP，要考虑：</p><ol><li>局部变量，及其每个变量的 size。</li><li>在函数中是否有对其它函数调用时，如果有的话，调用时需要将 callee 的参数、返回值考虑在内。虽然 return address(rip)的值也是存储在 caller 的 stack frame 上的，但是这个过程是由 CALL 指令和 RET 指令完成 PC 寄存器的保存和恢复的，在手写汇编时，同样也是不需要考虑这个 PC 寄存器在栈上所需占用的 8 个字节的。</li><li>原则上来说，调用函数时只要不把局部变量覆盖掉就可以了。稍微多分配几个字节的 framesize 也不会死。</li><li>在确保逻辑没有问题的前提下，你愿意覆盖局部变量也没有问题。只要保证进入和退出汇编函数时的 caller 和 callee 能正确拿到返回值就可以。</li></ol><h4 id="地址运算" tabindex="-1"><a class="header-anchor" href="#地址运算" aria-hidden="true">#</a> 地址运算</h4><p><code>lea</code>指令，load effective address，amd64 平台地址都是 8 个字节，所以直接就用 LEAQ</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>LEAQ (BX)(AX*8), CX
// 上面代码中的 8 代表 scale
// scale 只能是 0、2、4、8
// 如果写成其它值:
// LEAQ (BX)(AX*3), CX
// ./a.s:6: bad scale: 3

// 用 LEAQ 的话，即使是两个寄存器值直接相加，也必须提供 scale
// 下面这样是不行的
// LEAQ (BX)(AX), CX
// asm: asmidx: bad address 0/2064/2067
// 正确的写法是
LEAQ (BX)(AX*1), CX


// 在寄存器运算的基础上，可以加上额外的 offset
LEAQ 16(BX)(AX*1), CX

// 三个寄存器做运算，还是别想了
// LEAQ DX(BX)(AX*8), CX
// ./a.s:13: expected end of operand, found (
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实例</p><p>go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token comment">// 汇编函数声明</span>

<span class="token keyword">func</span> <span class="token function">sub</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token comment">// 汇编函数声明</span>

<span class="token keyword">func</span> <span class="token function">mul</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token comment">// 汇编函数声明</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>asm</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>#include &quot;textflag.h&quot; // 因为我们声明函数用到了 NOSPLIT 这样的 flag，所以需要将 textflag.h 包含进来

// func add(a, b int) int
TEXT ·add(SB), NOSPLIT, $0-24
    MOVQ a+0(FP), AX // 参数 a
    MOVQ b+8(FP), BX // 参数 b
    ADDQ BX, AX    // AX += BX
    MOVQ AX, ret+16(FP) // 返回
    RET

// func sub(a, b int) int
TEXT ·sub(SB), NOSPLIT, $0-24
    MOVQ a+0(FP), AX
    MOVQ b+8(FP), BX
    SUBQ BX, AX    // AX -= BX
    MOVQ AX, ret+16(FP)
    RET

// func mul(a, b int) int
TEXT ·mul(SB), NOSPLIT, $0-24
    MOVQ  a+0(FP), AX
    MOVQ  b+8(FP), BX
    IMULQ BX, AX    // AX *= BX
    MOVQ  AX, ret+16(FP)
    RET
    // 最后一行的空行是必须的，否则可能报 unexpected EOF
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="伪寄存器-sp-、伪寄存器-fp-和硬件寄存器-sp" tabindex="-1"><a class="header-anchor" href="#伪寄存器-sp-、伪寄存器-fp-和硬件寄存器-sp" aria-hidden="true">#</a> 伪寄存器 SP 、伪寄存器 FP 和硬件寄存器 SP</h3><p>todo</p><h3 id="其他" tabindex="-1"><a class="header-anchor" href="#其他" aria-hidden="true">#</a> 其他</h3><p>go</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>type address struct {
    lng int
    lat int
}
type person struct {
    age    int
    height int
    addr   address
}
func readStruct(p person) (int, int, int, int)
func main() {
    var p = person{
        age:    99,
        height: 88,
        addr: address{
            lng: 77,
            lat: 66,
        },
    }
    a, b, c, d := readStruct(p)
    println(a, b, c, d)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>asm</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>#include &quot;textflag.h&quot;

TEXT ·readStruct(SB), NOSPLIT, $0-64
    MOVQ arg0+0(FP), AX
    MOVQ AX, ret0+32(FP)
    MOVQ arg1+8(FP), AX
    MOVQ AX, ret1+40(FP)
    MOVQ arg2+16(FP), AX
    MOVQ AX, ret2+48(FP)
    MOVQ arg3+24(FP), AX
    MOVQ AX, ret3+56(FP)
    RET
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    m<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    n<span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// func mapassign_fast64(t *maptype, h *hmap, key uint64) unsafe.Pointer</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>asm</p><p>为<code>mapassign_fast64</code>的参数准备</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>// t *maptype
LEAQ    type.map[int]int(SB), AX
MOVQ    AX, (SP) // 0(SP) 第一个参数
// h *hmap
LEAQ    &quot;&quot;..autotmp_2+232(SP), AX
MOVQ    AX, 8(SP) // 8(SP) 第二个参数
// key uint64
MOVQ    $43, 16(SP) // 16(SP) 第三个参数写入43
CALL    runtime.mapassign_fast64(SB) // 返回参数就是key对应可以写值的内存地址，写入 24(SP)
MOVQ    24(SP), AX // 24(SP)是返回值的地址，写入到AX
MOVQ    $1, (AX) // 将值1写入这个返回值的地址
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>获取 goroutine id</p><p>go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> goroutineid

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;runtime&quot;</span>
	<span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> offsetDict <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int64</span><span class="token punctuation">{</span>
	<span class="token string">&quot;go1.4&quot;</span><span class="token punctuation">:</span>  <span class="token number">128</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.5&quot;</span><span class="token punctuation">:</span>  <span class="token number">184</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.6&quot;</span><span class="token punctuation">:</span>  <span class="token number">192</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.7&quot;</span><span class="token punctuation">:</span>  <span class="token number">192</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.8&quot;</span><span class="token punctuation">:</span>  <span class="token number">192</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.9&quot;</span><span class="token punctuation">:</span>  <span class="token number">152</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.10&quot;</span><span class="token punctuation">:</span> <span class="token number">152</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.11&quot;</span><span class="token punctuation">:</span> <span class="token number">152</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.12&quot;</span><span class="token punctuation">:</span> <span class="token number">152</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.13&quot;</span><span class="token punctuation">:</span> <span class="token number">152</span><span class="token punctuation">,</span>
	<span class="token string">&quot;go1.14&quot;</span><span class="token punctuation">:</span> <span class="token number">152</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> offset <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int64</span> <span class="token punctuation">{</span>
	ver <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">Version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> offsetDict<span class="token punctuation">[</span>ver<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// GetGoID returns the goroutine id</span>
<span class="token keyword">func</span> <span class="token function">GetGoID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int64</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>go_tls.h</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>#ifdef GOARCH_arm
#define LR R14
#endif

#ifdef GOARCH_amd64
#define    get_tls(r)    MOVQ TLS, r
#define    g(r)    0(r)(TLS*1)
#endif

#ifdef GOARCH_amd64p32
#define    get_tls(r)    MOVL TLS, r
#define    g(r)    0(r)(TLS*1)
#endif

#ifdef GOARCH_386
#define    get_tls(r)    MOVL TLS, r
#define    g(r)    0(r)(TLS*1)
#endif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>asm</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>#include &quot;textflag.h&quot;
#include &quot;go_tls.h&quot;

// func GetGoID() int64
TEXT ·GetGoID(SB), NOSPLIT, $0-8
	get_tls(CX)
	MOVQ g(CX), AX //
	MOVQ ·offset(SB), BX //
	LEAQ 0(AX)(BX*1), DX //
	MOVQ (DX), AX //
	MOVQ AX, ret+0(FP) //
	RET
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="simd" tabindex="-1"><a class="header-anchor" href="#simd" aria-hidden="true">#</a> SIMD</h3><p><a href="https://cch123.gitbooks.io/duplicate/content/part3/performance/simd-instruction-class.html" target="_blank" rel="noopener noreferrer">SIMD<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 是 Single Instruction, Multiple Data 的缩写，在 Intel 平台上的 SIMD 指令集先后为 SSE，AVX，AVX2，AVX512，这些指令集引入了标准以外的指令，和宽度更大的寄存器，例如:</p><ul><li>128 位的 XMM0~XMM31 寄存器。</li><li>256 位的 YMM0~YMM31 寄存器。</li><li>512 位的 ZMM0~ZMM31 寄存器。</li></ul><p>这些寄存器的关系，类似 RAX，EAX，AX 之间的关系。指令方面可以同时对多组数据进行移动或者计算，例如:</p><ul><li>movups : 把 4 个不对准的单精度值传送到 xmm 寄存器或者内存</li><li>movaps : 把 4 个对准的单精度值传送到 xmm 寄存器或者内存</li></ul><p>上述指令，当我们将数组作为函数的入参时有很大概率会看到</p><p>go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">pr</span><span class="token punctuation">(</span>input <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">pr</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>asm</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>0x001d 00029 (arr_par.go:10)    MOVQ    &quot;&quot;.statictmp_0(SB), AX
0x0024 00036 (arr_par.go:10)    MOVQ    AX, (SP)
0x0028 00040 (arr_par.go:10)    MOVUPS  &quot;&quot;.statictmp_0+8(SB), X0
0x002f 00047 (arr_par.go:10)    MOVUPS  X0, 8(SP)
0x0034 00052 (arr_par.go:10)    CALL    &quot;&quot;.pr(SB)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编译器在某些情况下已经考虑到了性能问题，帮助我们使用 SIMD 指令集来对数据搬运进行了优化。</p><h3 id="demo" tabindex="-1"><a class="header-anchor" href="#demo" aria-hidden="true">#</a> demo</h3><p>main.go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token comment">// &quot;asm/pkg&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Data <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Int    <span class="token builtin">int</span>
	String <span class="token builtin">string</span>
	Float  <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">addInt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Data <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Data<span class="token punctuation">{</span>Int<span class="token punctuation">:</span> a <span class="token operator">+</span> b<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	data <span class="token operator">:=</span> <span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>go tool compile <span class="token parameter variable">-N</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-S</span> main.go <span class="token operator">&gt;</span> main.tool.compile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>main.tool.compile</p><div class="language-asm line-numbers-mode" data-ext="asm"><pre class="language-asm"><code>&quot;&quot;.addInt STEXT size=177 args=0x18 locals=0x20 funcid=0x0
	;; 0x0000 00000 均为当前指令相对于当前函数的偏移量，第一个是 16 进制，第二个是 10 进制
	;; TEXT 函数申明
  ;; TEXT	位于内存的 .text 段
  ;; &quot;&quot;.addInt(SB)	&quot;&quot;为包名，链接时会填充；函数名 addInt；SB （static base）虚拟寄存器，基于静态地址，可认为是程序内存起始位置，所有用户定义的符号(如 main.addInt) 都作为偏移量写入伪寄存器 FP 和 SB
  ;; addInt 之所以使用 SB 是否是相对于 so 的函数而言，因为对于动态链接库的函数，函数的地址 = so 文件在进程内存空间的映射地址 + 函数偏移量，而静态链接的函数在编译器就可以确定地址
  ;; ABIInternal		编译器 flag，含义 application binary interface
  ;; 其他常见的编译器 flag 有 NOSPLIT
  ;; NOSPLIT 使编译器不要插入栈帧大小检查扩充代码，防止cpu做无用功
  ;; $32-24	函数栈帧大小为 32 字节，其中参数+返回值占用 24 字节
	0x0000 00000 (main.go:14)	TEXT	&quot;&quot;.addInt(SB), ABIInternal, $32-24
	;; MOV 数据搬运
	;; MOVB 	// 1 byte   B(Byte)
	;; MOVW 	// 2 bytes  W(Word)
	;; MOVL 	// 4 bytes  L(Long)
	;; MOVQ 	// 8 bytes  Q(Quadword)
	;; MOVSD    //
	;; MOVUPS   // 16 bytes 4个不对准的单精度值
	;; MOVAPS   // 16 bytes 4个对准的单精度值
	;; TLS 是一个由 runtime 维护的虚拟寄存器，保存了指向当前 g 的指针
	;; g 前 24 位数据结构如下：
	;; 0(TLS) uintptr g.stack.lo;
	;; 8(TLS) uintptr g.stack.hi; stack describes the actual stack memory: [stack.lo，stack.hi)
  ;; 16(TLS) uintptr g.stackguard0; stackguard0 is the stack pointer compared in the Go stack growth prologue.
	0x0000 00000 (main.go:14)	MOVQ	(TLS), CX
	;; CMP 比较大小
	;; 与 MOV 类似，CMPL，CMPQ ... 中的 L，Q 为 size 大小
	;; CMPQ	SP，16(CX) 表示将以 8bytes 的大小比较 SP，*(CX + 16) 即 g.stackguard0 的大小
	0x0009 00009 (main.go:14)	CMPQ	SP, 16(CX)
	;; PCDATA GC 相关
	;; PC表格: 针对每个函数和函数的每个指令生成一个地址表格，记录代码所在的文件路径、行号和函数的信息
	;; PCDATA tableid，tableoffset 第一个参数为表格的类型，第二个是表格的地址
	0x000d 00013 (main.go:14)	PCDATA	$0, $-2
	;; JLS jump less 小于时跳转
	;; CMPQ	SP，16(CX); JLS	167 表示若 SP &lt; *(CX + 16) 跳转到 00167
	;; 当 g 的 satck 不足时, 跳转到 00167 执行扩容函数
	0x000d 00013 (main.go:14)	JLS	167
	0x0013 00019 (main.go:14)	PCDATA	$0, $-1
	;; 栈调整
	;; SUBQ	$32，SP 对 SP 做减法，为函数分配函数栈帧
	0x0013 00019 (main.go:14)	SUBQ	$32, SP
	;; MOV 数据搬运
	;; 使用 MOV，CMP 的时候会有看到带括号和不带括号的区别
	;; MOVQ 16(AX)，BX	// =&gt; BX = *(AX + 16)
	;; MOVQ AX，BX		// =&gt; BX = AX 将AX中存储的内容赋值给BX，注意区别
	;; CMPB	(AX)，$48	// 以 byte 的 size 比较 *(AX) 48
	;; MOVQ	BP，24(SP) 表示将 BP 赋值给 *(SP + 24)，作用为保存调用者的 BP
	0x0017 00023 (main.go:14)	MOVQ	BP, 24(SP)
	;; LEA Load Effective Address 地址运算，类似 &amp;
	;; LEAQ	24(SP)，BP 表示将 (SP + 24) 赋值给 BP，作用为设置新的 BP
	0x001c 00028 (main.go:14)	LEAQ	24(SP), BP
	;; FUNCDATA GC相关
	;; FUNC 表格用于记录函数的参数、局部变量的指针信息
	0x0021 00033 (main.go:14)	FUNCDATA	$0, gclocals·54241e171da8af6ae173d69da0236748(SB)
	0x0021 00033 (main.go:14)	FUNCDATA	$1, gclocals·2a5305abe05176240e61b8620e19a815(SB)
	;; MOVQ	$0，&quot;&quot;.~r2+56(SP)表示将 0 赋值给 *(56 + SP)
	;; .r2 是分配给引用地址的任意别名；尽管没有任何语义上的含义，但在使用虚拟寄存器和相对地址时，这种别名是需要强制使用的。
	;; &quot;&quot;.~r2+56(SP) 格式 $pkg_name.~$var_name+size(reg)
	0x0021 00033 (main.go:14)	MOVQ	$0, &quot;&quot;.~r2+56(SP)
	0x002a 00042 (main.go:15)	LEAQ	type.&quot;&quot;.Data(SB), AX
	0x0031 00049 (main.go:15)	MOVQ	AX, (SP)
	0x0035 00053 (main.go:15)	PCDATA	$1, $0
	;; CALL 调用函数，函数定义：func newobject(typ *_type) unsafe.Pointer
	;; 调用函数 runtime.newobject，依据上下文（SP）为参数，8（SP）为返回值
	;; 内存逃逸：runtime.newobject 会导致对象分配到堆上
	0x0035 00053 (main.go:15)	CALL	runtime.newobject(SB)
	0x003a 00058 (main.go:15)	MOVQ	8(SP), AX
	0x003f 00063 (main.go:15)	MOVQ	AX, &quot;&quot;..autotmp_3+16(SP)
	0x0044 00068 (main.go:15)	MOVQ	$0, (AX)
	0x004b 00075 (main.go:15)	MOVQ	$0, 16(AX)
	;; XORPS 源操作数（第二个操作数）与目标操作数（第一个操作数）进行异或。结果保存到目标操作数
	;; XORPS	X0，X0 初始化寄存器 X0
	0x0053 00083 (main.go:15)	XORPS	X0, X0
	0x0056 00086 (main.go:15)	MOVSD	X0, 24(AX)
	0x005b 00091 (main.go:15)	LEAQ	8(AX), DI
	0x005f 00095 (main.go:15)	PCDATA	$0, $-2
	;; GC相关，是否需要写屏障
	0x005f 00095 (main.go:15)	CMPL	runtime.writeBarrier(SB), $0
	;; JEQ jump equal 等于时跳转
	0x0066 00102 (main.go:15)	JEQ	106
	;; JMP 无条件跳转
	;; JMP addr   // 跳转到地址，地址可为代码中的地址
	;; JMP label  // 跳转到标签，可以跳转到同一函数内的标签位置
	;; JMP 2(PC)  // 以当前指令为基础，向后跳转 2 行
	0x0068 00104 (main.go:15)	JMP	156
	0x006a 00106 (main.go:15)	MOVQ	$0, 8(AX)
	0x0072 00114 (main.go:15)	JMP	116
	0x0074 00116 (main.go:15)	PCDATA	$0, $-1
	0x0074 00116 (main.go:15)	MOVQ	&quot;&quot;..autotmp_3+16(SP), AX
	0x0079 00121 (main.go:15)	TESTB	AL, (AX)
	0x007b 00123 (main.go:15)	MOVQ	&quot;&quot;.a+40(SP), CX
	0x0080 00128 (main.go:15)	ADDQ	&quot;&quot;.b+48(SP), CX
	0x0085 00133 (main.go:15)	MOVQ	CX, (AX)
	0x0088 00136 (main.go:15)	MOVQ	&quot;&quot;..autotmp_3+16(SP), AX
	0x008d 00141 (main.go:15)	MOVQ	AX, &quot;&quot;.~r2+56(SP)
	;; 栈调整
	;; ADDQ	$32，SP  对 SP 做加法，清除函数栈帧
	0x0092 00146 (main.go:15)	MOVQ	24(SP), BP
	0x0097 00151 (main.go:15)	ADDQ	$32, SP
	;; RET 返回
	0x009b 00155 (main.go:15)	RET
	0x009c 00156 (main.go:15)	PCDATA	$0, $-2
	0x009c 00156 (main.go:15)	XORL	AX, AX
	0x009e 00158 (main.go:15)	NOP
	0x00a0 00160 (main.go:15)	CALL	runtime.gcWriteBarrier(SB)
	0x00a5 00165 (main.go:15)	JMP	116
	;; NOP 空操作，占用一个时钟周期，用于延时或者程序指令的对齐
	0x00a7 00167 (main.go:15)	NOP
	0x00a7 00167 (main.go:14)	PCDATA	$1, $-1
	0x00a7 00167 (main.go:14)	PCDATA	$0, $-2
	;; CALL runtime.morestack satck 扩容
	0x00a7 00167 (main.go:14)	CALL	runtime.morestack_noctxt(SB)
	0x00ac 00172 (main.go:14)	PCDATA	$0, $-1
	0x00ac 00172 (main.go:14)	JMP	0
	0x0000 64 48 8b 0c 25 00 00 00 00 48 3b 61 10 0f 86 94  dH..%....H;a....
	0x0010 00 00 00 48 83 ec 20 48 89 6c 24 18 48 8d 6c 24  ...H.. H.l$.H.l$
	0x0020 18 48 c7 44 24 38 00 00 00 00 48 8d 05 00 00 00  .H.D$8....H.....
	0x0030 00 48 89 04 24 e8 00 00 00 00 48 8b 44 24 08 48  .H..$.....H.D$.H
	0x0040 89 44 24 10 48 c7 00 00 00 00 00 48 c7 40 10 00  .D$.H......H.@..
	0x0050 00 00 00 0f 57 c0 f2 0f 11 40 18 48 8d 78 08 83  ....W....@.H.x..
	0x0060 3d 00 00 00 00 00 74 02 eb 32 48 c7 40 08 00 00  =.....t..2H.@...
	0x0070 00 00 eb 00 48 8b 44 24 10 84 00 48 8b 4c 24 28  ....H.D$...H.L$(
	0x0080 48 03 4c 24 30 48 89 08 48 8b 44 24 10 48 89 44  H.L$0H..H.D$.H.D
	0x0090 24 38 48 8b 6c 24 18 48 83 c4 20 c3 31 c0 66 90  $8H.l$.H.. .1.f.
	0x00a0 e8 00 00 00 00 eb cd e8 00 00 00 00 e9 4f ff ff  .............O..
	0x00b0 ff                                               .
	rel 5+4 t=17 TLS+0
	rel 45+4 t=16 type.&quot;&quot;.Data+0
	rel 54+4 t=8 runtime.newobject+0
	rel 97+4 t=16 runtime.writeBarrier+-1
	rel 161+4 t=8 runtime.gcWriteBarrier+0
	rel 168+4 t=8 runtime.morestack_noctxt+0
&quot;&quot;.main STEXT size=186 args=0x0 locals=0x78 funcid=0x0
	0x0000 00000 (main.go:18)	TEXT	&quot;&quot;.main(SB), ABIInternal, $120-0
	0x0000 00000 (main.go:18)	MOVQ	(TLS), CX
	0x0009 00009 (main.go:18)	CMPQ	SP, 16(CX)
	0x000d 00013 (main.go:18)	PCDATA	$0, $-2
	0x000d 00013 (main.go:18)	JLS	176
	0x0013 00019 (main.go:18)	PCDATA	$0, $-1
	0x0013 00019 (main.go:18)	SUBQ	$120, SP
	0x0017 00023 (main.go:18)	MOVQ	BP, 112(SP)
	0x001c 00028 (main.go:18)	LEAQ	112(SP), BP
	0x0021 00033 (main.go:18)	FUNCDATA	$0, gclocals·33cdeccccebe80329f1fdbee7f5874cb(SB)
	0x0021 00033 (main.go:18)	FUNCDATA	$1, gclocals·1d0ed49f611d7e40a62328b5976a2ede(SB)
	0x0021 00033 (main.go:18)	FUNCDATA	$2, &quot;&quot;.main.stkobj(SB)
	;; CALL 参数:（SP），8（SP）
	0x0021 00033 (main.go:19)	MOVQ	$1, (SP)
	0x0029 00041 (main.go:19)	MOVQ	$2, 8(SP)
	0x0032 00050 (main.go:19)	PCDATA	$1, $0
	;; CALL
	0x0032 00050 (main.go:19)	CALL	&quot;&quot;.addInt(SB)
	;; CALL 返回值 16（SP）
	0x0037 00055 (main.go:19)	MOVQ	16(SP), AX
	0x003c 00060 (main.go:19)	MOVQ	AX, &quot;&quot;.data+48(SP)
	0x0041 00065 (main.go:20)	MOVQ	AX, &quot;&quot;..autotmp_1+64(SP)
	0x0046 00070 (main.go:20)	XORPS	X0, X0
	0x0049 00073 (main.go:20)	MOVUPS	X0, &quot;&quot;..autotmp_2+72(SP)
	0x004e 00078 (main.go:20)	LEAQ	&quot;&quot;..autotmp_2+72(SP), AX
	0x0053 00083 (main.go:20)	MOVQ	AX, &quot;&quot;..autotmp_4+56(SP)
	0x0058 00088 (main.go:20)	TESTB	AL, (AX)
	0x005a 00090 (main.go:20)	MOVQ	&quot;&quot;..autotmp_1+64(SP), CX
	0x005f 00095 (main.go:20)	LEAQ	type.*&quot;&quot;.Data(SB), DX
	0x0066 00102 (main.go:20)	MOVQ	DX, &quot;&quot;..autotmp_2+72(SP)
	0x006b 00107 (main.go:20)	MOVQ	CX, &quot;&quot;..autotmp_2+80(SP)
	0x0070 00112 (main.go:20)	TESTB	AL, (AX)
	0x0072 00114 (main.go:20)	JMP	116
	0x0074 00116 (main.go:20)	MOVQ	AX, &quot;&quot;..autotmp_3+88(SP)
	0x0079 00121 (main.go:20)	MOVQ	$1, &quot;&quot;..autotmp_3+96(SP)
	0x0082 00130 (main.go:20)	MOVQ	$1, &quot;&quot;..autotmp_3+104(SP)
	0x008b 00139 (main.go:20)	MOVQ	AX, (SP)
	0x008f 00143 (main.go:20)	MOVQ	$1, 8(SP)
	0x0098 00152 (main.go:20)	MOVQ	$1, 16(SP)
	0x00a1 00161 (main.go:20)	CALL	fmt.Println(SB)
	0x00a6 00166 (main.go:21)	MOVQ	112(SP), BP
	0x00ab 00171 (main.go:21)	ADDQ	$120, SP
	0x00af 00175 (main.go:21)	RET
	0x00b0 00176 (main.go:21)	NOP
	0x00b0 00176 (main.go:18)	PCDATA	$1, $-1
	0x00b0 00176 (main.go:18)	PCDATA	$0, $-2
	0x00b0 00176 (main.go:18)	CALL	runtime.morestack_noctxt(SB)
	0x00b5 00181 (main.go:18)	PCDATA	$0, $-1
	0x00b5 00181 (main.go:18)	JMP	0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/xyz3282836/monodoc/edit/master/packages/note/src/go/asm/plan9.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: liuruizhou@bilibili.com">liuruizhou</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/go/asm/dlv%E5%91%BD%E4%BB%A4.html" class="nav-link prev" aria-label="dlv 命令"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->dlv 命令</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">默认页脚</div><div class="copyright">Copyright © 2023 rz</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-e5f4882f.js" defer></script>
  </body>
</html>
